ü
YD:\OneDrive\Benner\Visual Studio 2015\Projects\WFTesteFila\WFTesteFila\CompactaArquivo.cs
	namespace 	
Benner
 
. 
Saude 
. 
Postal 
. 
Zip !
.! "
Business" *
{ 
public 

class 
CompactaArquivo  
{ 
public		 
static		 
void		 
	Compactar		 $
(		$ %
string		% +
caminhoDoZip		, 8
,		8 9
string		: @
arquivo		A H
)		H I
{

 	
string 
[ 
] 
arquivos 
= 
arquivo  '
.' (
Split( -
(- .
$char. 1
)1 2
;2 3
if 
( 
arquivo 
. 
Length 
>  
$num! "
)" #
{ 
foreach 
( 
string 
item  $
in% '
arquivos( 0
)0 1
{ 
CompactarArquivo $
($ %
caminhoDoZip% 1
,1 2
item3 7
)7 8
;8 9
} 
} 
else 
{ 
CompactarArquivo  
(  !
caminhoDoZip! -
,- .
arquivo/ 6
)6 7
;7 8
} 
} 	
private 
static 
void 
CompactarArquivo ,
(, -
string- 3
caminhoDoZip4 @
,@ A
stringB H
arquivoI P
)P Q
{ 	
if 
( 
! 
File 
. 
Exists 
( 
arquivo $
)$ %
)% &
throw 
new 
	Exception #
(# $
string$ *
.* +
Concat+ 1
(1 2
$str2 =
,= >
arquivo? F
,F G
$strH [
)[ \
)\ ]
;] ^
if 
( 
! 
File 
. 
Exists 
( 
caminhoDoZip )
)) *
)* +
{ 
using   
(   

ZipArchive   !
zip  " %
=  & '
ZipFile  ( /
.  / 0
Open  0 4
(  4 5
caminhoDoZip  5 A
,  A B
ZipArchiveMode  C Q
.  Q R
Create  R X
)  X Y
)  Y Z
{!! 
zip"" 
."" 
CreateEntryFromFile"" +
(""+ ,
arquivo"", 3
,""3 4
Path""5 9
.""9 :
GetFileName"": E
(""E F
arquivo""F M
)""M N
)""N O
;""O P
}## 
}$$ 
else%% 
{&& 
using'' 
('' 

ZipArchive'' !
zip''" %
=''& '
ZipFile''( /
.''/ 0
Open''0 4
(''4 5
caminhoDoZip''5 A
,''A B
ZipArchiveMode''C Q
.''Q R
Update''R X
)''X Y
)''Y Z
{(( 
zip)) 
.)) 
CreateEntryFromFile)) +
())+ ,
arquivo)), 3
,))3 4
Path))5 9
.))9 :
GetFileName)): E
())E F
arquivo))F M
)))M N
)))N O
;))O P
}** 
}++ 
},, 	
}-- 
}.. Í6
OD:\OneDrive\Benner\Visual Studio 2015\Projects\WFTesteFila\WFTesteFila\Form1.cs
	namespace 	
WFTesteFila
 
{ 
public 

partial 
class 
Form1 
:  
Form! %
{		 
MessageQueue

 
mQ

 
;

 
System 
. 
	Messaging 
. 
Message  
msg! $
;$ %
BinaryReader 
br 
; 
public 
Form1 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
btnEnviar_Click $
($ %
object% +
sender, 2
,2 3
	EventArgs4 =
e> ?
)? @
{ 	
string 
textoMsg 
= 
DateTime &
.& '
Now' *
.* +
	TimeOfDay+ 4
.4 5
ToString5 =
(= >
)> ?
+@ A
$strB E
+F G
txtMensagemH S
.S T
TextT X
;X Y
if 
( 
MessageQueue 
. 
Exists #
(# $
$str$ ;
); <
)< =
{ 
mQ 
= 
new 
MessageQueue %
(% &
$str& =
)= >
;> ?
} 
else 
{ 
mQ 
= 
MessageQueue !
.! "
Create" (
(( )
$str) @
)@ A
;A B
} 
mQ 
. 
Send 
( 
textoMsg 
, 
$str )
)) *
;* +
lstMSMQ 
. 
Items 
. 
Add 
( 
string $
.$ %
Format% +
(+ ,
$str, U
,U V
DateTimeW _
._ `
Now` c
.c d
	TimeOfDayd m
.m n
ToStringn v
(v w
)w x
)x y
)y z
;z {
if   
(   
textoMsg   
==   
$str   
)   

MessageBox!! 
.!! 
Show!! 
(!!  
$str!!  "
)!!" #
;!!# $
}"" 	
private$$ 
void$$ 
btnLer_Click$$ !
($$! "
object$$" (
sender$$) /
,$$/ 0
	EventArgs$$1 :
e$$; <
)$$< =
{%% 	
string&& 
texto&& 
;&& 
try'' 
{(( 
msg)) 
=)) 
mQ)) 
.)) 
Receive))  
())  !
new))! $
TimeSpan))% -
())- .
$num)). /
,))/ 0
$num))1 2
,))2 3
$num))4 5
)))5 6
)))6 7
;))7 8
br** 
=** 
new** 
BinaryReader** %
(**% &
msg**& )
.**) *

BodyStream*** 4
)**4 5
;**5 6
texto++ 
=++ 
new++ 
string++ "
(++" #
br++# %
.++% &
	ReadChars++& /
(++/ 0
Convert++0 7
.++7 8
ToInt32++8 ?
(++? @
msg++@ C
.++C D

BodyStream++D N
.++N O
Length++O U
)++U V
)++V W
)++W X
;++X Y
lstMSMQ,, 
.,, 
Items,, 
.,, 
Add,, !
(,,! "
string,," (
.,,( )
Format,,) /
(,,/ 0
$str,,0 ;
,,,; <
texto,,= B
),,B C
),,C D
;,,D E
}-- 
catch.. 
{// 
lstMSMQ00 
.00 
Items00 
.00 
Add00 !
(00! "
$str00" A
)00A B
;00B C
}11 
}22 	
private44 
void44 
button1_Click44 "
(44" #
object44# )
sender44* 0
,440 1
	EventArgs442 ;
e44< =
)44= >
{55 	
try66 
{77 
	treeView188 
.88 
Nodes88 
.88  
Clear88  %
(88% &
)88& '
;88' (
	treeView199 
.99 
BeginUpdate99 %
(99% &
)99& '
;99' (
MessageQueue;; 
[;; 
];; 
filas;; $
=;;% &
MessageQueue;;' 3
.;;3 4%
GetPrivateQueuesByMachine;;4 M
(;;M N
$str;;N Y
);;Y Z
;;;Z [
foreach== 
(== 
MessageQueue== %
fila==& *
in==+ -
filas==. 3
)==3 4
{>> 
TreeNode?? 
qNode?? "
=??# $
new??% (
TreeNode??) 1
{@@ 
TextAA 
=AA 
filaAA #
.AA# $
	QueueNameAA$ -
,AA- .
TagBB 
=BB 
$strBB $
}CC 
;CC 
	treeView1EE 
.EE 
NodesEE #
.EE# $
AddEE$ '
(EE' (
qNodeEE( -
)EE- .
;EE. /
foreachGG 
(GG 
SystemGG #
.GG# $
	MessagingGG$ -
.GG- .
MessageGG. 5
messageGG6 =
inGG> @
filaGGA E
)GGE F
{HH 
TreeNodeII  
mNodeII! &
=II' (
newII) ,
TreeNodeII- 5
{JJ 
TagKK 
=KK  !
$strKK" '
,KK' (
TextLL  
=LL! "
messageLL# *
.LL* +
LabelLL+ 0
}MM 
;MM 
	treeView1NN !
.NN! "
NodesNN" '
[NN' (
ArrayNN( -
.NN- .
IndexOfNN. 5
(NN5 6
filasNN6 ;
,NN; <
filaNN= A
)NNA B
]NNB C
.NNC D
NodesNND I
.NNI J
AddNNJ M
(NNM N
mNodeNNN S
)NNS T
;NNT U
}OO 
}PP 
	treeView1QQ 
.QQ 
	EndUpdateQQ #
(QQ# $
)QQ$ %
;QQ% &
}RR 
catchSS 
(SS 
	ExceptionSS 
exSS 
)SS  
{TT 

MessageBoxUU 
.UU 
ShowUU 
(UU  
exUU  "
.UU" #
MessageUU# *
,UU* +
$strUU, 2
,UU2 3
MessageBoxButtonsUU4 E
.UUE F
OKUUF H
,UUH I
MessageBoxIconUUJ X
.UUX Y
ErrorUUY ^
)UU^ _
;UU_ `
}VV 
}WW 	
}XX 
}YY †
PD:\OneDrive\Benner\Visual Studio 2015\Projects\WFTesteFila\WFTesteFila\Pessoa.cs
	namespace 	
WFTesteFila
 
{ 
public 

class 
Pessoa 
{ 
public 
Pessoa 
( 
string 
nome !
,! "
DateTime# +
aniversario, 7
)7 8
{ 	
Nome		 
=		 
nome		 
;		 
Aniversario

 
=

 
aniversario

 %
;

% &
} 	
public 
string 
Nome 
{ 
get  
;  !
set" %
;% &
}' (
public 
DateTime 
Aniversario "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} Ò
QD:\OneDrive\Benner\Visual Studio 2015\Projects\WFTesteFila\WFTesteFila\Program.cs
	namespace 	
WFTesteFila
 
{ 
static		 

class		 
Program		 
{

 
[ 	
	STAThread	 
] 
static 
void 
Main 
( 
) 
{ 	
Application 
. 
EnableVisualStyles *
(* +
)+ ,
;, -
Application 
. -
!SetCompatibleTextRenderingDefault 9
(9 :
false: ?
)? @
;@ A
Application 
. 
Run 
( 
new 
Form1  %
(% &
)& '
)' (
;( )
} 	
} 
} Œ
aD:\OneDrive\Benner\Visual Studio 2015\Projects\WFTesteFila\WFTesteFila\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str &
)& '
]' (
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str (
)( )
]) *
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *